# Checks that peephole pass works.

RUN: %clang %p/Inputs/peephole.s -o %t.exe
RUN: llvm-bolt %t.exe -o %t -peepholes=shorten
RUN: llvm-objdump -d --disassemble-symbols=main %t | FileCheck %s

CHECK: main
CHECK-NEXT:  49 81 6d 00 00 00 00 02 	subq	$33554432, (%r13)
CHECK-NEXT:  49 83 6d 00 02           subq	$2, (%r13)
CHECK-NEXT:  48 31 c0 	              xorq	%rax, %rax
CHECK-NEXT:  c3 	                    retq
