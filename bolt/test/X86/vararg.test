# Check that a function that references a label inside itself,
# as in the case of vararg handling code generated by GCC 4.5
# and earlier, is recognized as multi-entry.

REQUIRES: x86_64-linux

RUN: %clangxx %p/../Inputs/vararg.s -o %t -Wl,-q
RUN: llvm-bolt %t -o /dev/null -print-cfg -print-only=.*printf.* |& FileCheck %s
RUN: %clangxx %p/Inputs/vararg_pic.s -o %t.pic -Wl,-q
RUN: llvm-bolt %t.pic -o /dev/null -print-cfg -print-only=.*printf.* \
RUN:    |& FileCheck -check-prefix=CHECK-PIC %s

CHECK: IsSimple    : 0
CHECK: Entry Point
CHECK: Entry Point

CHECK-PIC: IsSimple    : 0
CHECK-PIC: Entry Point
CHECK-PIC: Entry Point
